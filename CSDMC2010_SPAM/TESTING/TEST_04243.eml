X-Account-Key: account5
X-UIDL: GmailId1286e0e5adf69936
X-Mozilla-Status: 0000
X-Mozilla-Status2: 00000000
X-Mozilla-Keys:                                                                                 
Delivered-To: mlsubscriber.tech@csmining.org
Received: by 10.142.81.20 with SMTP id e20cs397625wfb;
        Thu, 6 May 2010 07:39:15 -0700 (PDT)
Received: by 10.87.61.22 with SMTP id o22mr1669151fgk.50.1273156754382;
        Thu, 06 May 2010 07:39:14 -0700 (PDT)
Return-Path: <bounce-debian-user=mlsubscriber.tech=csmining.org@lists.debian.org>
Received: from liszt.debian.org (liszt.debian.org [82.195.75.100])
        by mx.google.com with ESMTP id c28si2180691fka.14.2010.05.06.07.39.13;
        Thu, 06 May 2010 07:39:14 -0700 (PDT)
Received-SPF: pass (google.com: manual fallback record for domain of bounce-debian-user=mlsubscriber.tech=csmining.org@lists.debian.org designates 82.195.75.100 as permitted sender) client-ip=82.195.75.100;
Authentication-Results: mx.google.com; spf=pass (google.com: manual fallback record for domain of bounce-debian-user=mlsubscriber.tech=csmining.org@lists.debian.org designates 82.195.75.100 as permitted sender) smtp.mail=bounce-debian-user=mlsubscriber.tech=csmining.org@lists.debian.org; dkim=neutral (body hash did not verify) header.i=@csmining.org
Received: from localhost (localhost [127.0.0.1])
	by liszt.debian.org (Postfix) with QMQP
	id 0494A2D0CF7; Thu,  6 May 2010 14:39:08 +0000 (UTC)
Old-Return-Path: <noelamac@csmining.org>
XChecker-Version: SpamAssassin 3.2.5 (2008-06-10) on liszt.debian.org
XLevel: 
XStatus: No, score=-4.9 required=4.0 tests=FOURLA,STATIC_RIMA_TDE
	autolearn=failed version=3.2.5
X-Original-To: lists-debian-user@liszt.debian.org
Delivered-To: lists-debian-user@liszt.debian.org
Received: from localhost (localhost [127.0.0.1])
	by liszt.debian.org (Postfix) with ESMTP id 7224113A5806
	for <lists-debian-user@liszt.debian.org>; Thu,  6 May 2010 14:22:06 +0000 (UTC)
X-Virus-Scanned: at lists.debian.org with policy bank en-ht
X-AmavisStatus: No, score=-6.9 tagged_above=-10000 required=5.3
	tests=[BAYES_00=-2, FOURLA=0.1, STATIC_RIMA_TDE=-5] autolearn=ham
Received: from liszt.debian.org ([127.0.0.1])
	by localhost (lists.debian.org [127.0.0.1]) (amavisd-new, port 2525)
	with ESMTP id iW0Sg-A8JqQ6 for <lists-debian-user@liszt.debian.org>;
	Thu,  6 May 2010 14:21:58 +0000 (UTC)
X-policyd-weight: using cached result; rate:hard: -6.9
Received: from mail-wy0-f175.google.com (mail-wy0-f175.google.com [74.125.82.175])
	by liszt.debian.org (Postfix) with ESMTP id CA8F013A5805
	for <debian-user@lists.debian.org>; Thu,  6 May 2010 14:21:58 +0000 (UTC)
Received: by wyf22 with SMTP id 22so6491wyf.6
        for <debian-user@lists.debian.org>; Thu, 06 May 2010 07:21:51 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=csmining.org; s=gamma;
        h=domainkey-signature:received:received:date:from:to:subject
         :message-id:references:mime-version:content-type:content-disposition
         :content-transfer-encoding:in-reply-to:user-agent;
        bh=7CFt28MMa2K4SqGh6PEsvOpVrpLlasKDH779vN3h3k0=;
        b=Pu5Tq0dHdcIulw1VOmVufTuAQBFuhMBO1VAJwSurDagrJkOUt1chjtPzE8DR5D2tiL
         3utBWB1ASm/N7NdPLFqtoZeR7wvUPXKXZMOpQ4a7/f1nmiK2mBiyoxi53WP9mQ+G7L+8
         ZHun7pk9d7DxuImfbCsAf7uSY1igw0Wy6BjhY=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=csmining.org; s=gamma;
        h=date:from:to:subject:message-id:references:mime-version
         :content-type:content-disposition:content-transfer-encoding
         :in-reply-to:user-agent;
        b=BrVRwQ/JJVCQSbliRdI2GsdMWMwUg7Mby1Mhdhm42uB8fVgt5+NDF+b2ptMrKAN8Dx
         ltJkEschU2ZGVtsItnKu/sYyHMSAQ/8hF9cU/xoP8Dnk5jilOSbzhgIsbFwOikEhaZdh
         zeYzvSuTbUL63covQ06PWnm2bzYIprtUkiGtQ=
Received: by 10.227.146.130 with SMTP id h2mr4432539wbv.70.1273155708184;
        Thu, 06 May 2010 07:21:48 -0700 (PDT)
Received: from stt008.linux.site (75.Red-213-96-214.staticIP.rima-tde.net [213.96.214.75])
        by mx.google.com with ESMTPS id b2sm7717154wbb.2.2010.05.06.07.21.46
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Thu, 06 May 2010 07:21:47 -0700 (PDT)
Date: Thu, 6 May 2010 16:21:43 +0200
From: =?utf-8?B?Q2FtYWxlw7Nu?= <noelamac@csmining.org>
To: "Debian [en]" <debian-user@lists.debian.org>
Subject: Re: How to flush cache of certain disk?
Message-ID: <20100506142143.GA11722@stt008.linux.site>
References: <p2u28c1d5ea1005060246p3434d45dy6b9ca5b6d34a08de@mail.csmining.org> <pan.2010.05.06.13.17.15@csmining.org> <o2l28c1d5ea1005060636v9349f817jf2f4db5241536a22@mail.csmining.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Disposition: inline
Content-Transfer-Encoding: 8bit
In-Reply-To: <o2l28c1d5ea1005060636v9349f817jf2f4db5241536a22@mail.csmining.org>
User-Agent: Mutt/1.5.18 (2008-05-17)
X-Rc-Spam: 2008-11-04_01
X-Rc-Virus: 2007-09-13_01
X-Rc-Spam: 2008-11-04_01
Resent-Message-ID: <mIw0A1myBVI.A.fpG.LSt4LB@liszt>
Resent-From: debian-user@lists.debian.org
X-Mailing-List: <debian-user@lists.debian.org> archive/latest/576007
X-Loop: debian-user@lists.debian.org
List-Id: <debian-user.lists.debian.org>
List-Post: <mailto:debian-user@lists.debian.org>
List-Help: <mailto:debian-user-request@lists.debian.org?subject=help>
List-Subscribe: <mailto:debian-user-request@lists.debian.org?subject=subscribe>
List-Unsubscribe: <mailto:debian-user-request@lists.debian.org?subject=unsubscribe>
Precedence: list
Resent-Sender: debian-user-request@lists.debian.org
Resent-Date: Thu,  6 May 2010 14:39:08 +0000 (UTC)

El 2010-05-06 a las 16:36 +0300, Alexander Batischev escribió:

(resending to the list)

> Hi, and thanks for response!
> 
> On 6 May 2010 16:17, Camaleón wrote:
> >> On my netbook I'm using automatic USB sticks mount through udev rules,
> >> and I already used to running 'sync' command before unplugging stick, so
> >> no data will be lost. But if I have few sticks inserted and some
> >> information copying on one of them, if I run 'sync' I have to wait while
> >> copying ends, because:
> >>
> >> a) sync command drops cache on disk, but copying process fill it again;
> >> sync will work until all the caches are dropped to disks
> >
> > Dunno if this would fit your needs, but there is a "sync" option for
> > mount points you can use to ensure all removable devices (or only the
> > ones you select) get mounted with "-o sync" flag.
> >
> > But I would be a bit reluctant to use that, because as per "man mount"
> > page that flag can shorten the life of flash drive based devices with a
> > limited number of write operations.
> 
> Yes, that's why all USB sticks are mounted with async option and
> that's a reason to use 'sync' before unplugging them.

O.k.
 
> >> b) I can't unplug stick when it stops to flash because I can't be sure
> >> that there are no more parts of cache needed to be flushed on that disk.
> >>
> >> So here is my question - how can I run sync for only one device?
> >
> > To avoid data loss you have to "umount" the device first (or just "eject"
> > if that options is available in your system). Umount/eject operation
> > should care the data is correctly stored in the media before powering off
> > or unplugging the device.
> 
> Well, yes, that's right, but I don't unmount sticks by myself — udev
> does that when I unplug USB device. Let me describe how automounting
> implemented so it would be more clear to you.
> 
> When I put my flash drive into USB port, udev recognizes that, checks
> drive for filesystem type, and mount it if it's FAT or NTFS. After
> that I can work with mounted stick.

Right.

> When I unplug stick, udev unmounts it from mountpoint. Pay attention
> to moment of unmount - it happens *after* unplugging, so no cache can
> be flushed as far as device is already disconnected.
> 
> I though about running umount /mnt/sd[a-z] before unplugging, but then
> decided to ask for a better way. If I won't find it, umount will be
> the solution. So, any other options?

I never do that way. I always first "umount" the device and then, I 
remove the stick, but not the reverse. Removable media has to be done 
that way, to prevent data loss or flash drive damage, or that is what 
manufacturers say :-?

Greetings,

-- 
Camaleón 


-- 
To UNSUBSCRIBE, email to debian-user-REQUEST@lists.debian.org 
with a subject of "unsubscribe". Trouble? Contact listmaster@lists.debian.org
Archive: http://lists.debian.org/20100506142143.GA11722@stt008.linux.site


