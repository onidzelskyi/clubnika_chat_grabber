X-Account-Key: account5
X-UIDL: GmailId127f38b400840dbd
X-Mozilla-Status: 0000
X-Mozilla-Status2: 00000000
X-Mozilla-Keys:                                                                                 
Delivered-To: mlsubscriber.tech@csmining.org
Received: by 10.143.158.12 with SMTP id k12cs162768wfo;
        Mon, 12 Apr 2010 12:42:23 -0700 (PDT)
Received: by 10.223.45.83 with SMTP id d19mr2815585faf.65.1271101342075;
        Mon, 12 Apr 2010 12:42:22 -0700 (PDT)
Return-Path: <bounce-debian-user=mlsubscriber.tech=csmining.org@lists.debian.org>
Received: from liszt.debian.org (liszt.debian.org [82.195.75.100])
        by mx.google.com with ESMTP id e17si9209139fke.57.2010.04.12.12.42.21;
        Mon, 12 Apr 2010 12:42:22 -0700 (PDT)
Received-SPF: pass (google.com: manual fallback record for domain of bounce-debian-user=mlsubscriber.tech=csmining.org@lists.debian.org designates 82.195.75.100 as permitted sender) client-ip=82.195.75.100;
Authentication-Results: mx.google.com; spf=pass (google.com: manual fallback record for domain of bounce-debian-user=mlsubscriber.tech=csmining.org@lists.debian.org designates 82.195.75.100 as permitted sender) smtp.mail=bounce-debian-user=mlsubscriber.tech=csmining.org@lists.debian.org
Received: from localhost (localhost [127.0.0.1])
	by liszt.debian.org (Postfix) with QMQP
	id 70FE22D0FEC; Mon, 12 Apr 2010 19:42:10 +0000 (UTC)
Old-Return-Path: <florian.kulzer+debian@icfo.es>
XChecker-Version: SpamAssassin 3.2.5 (2008-06-10) on liszt.debian.org
XLevel: 
XStatus: No, score=-3.9 required=4.0 tests=FOURLA,RCVD_IN_DNSWL_MED
	autolearn=no version=3.2.5
X-Original-To: lists-debian-user@liszt.debian.org
Delivered-To: lists-debian-user@liszt.debian.org
Received: from localhost (localhost [127.0.0.1])
	by liszt.debian.org (Postfix) with ESMTP id 59A7013A636C
	for <lists-debian-user@liszt.debian.org>; Mon, 12 Apr 2010 19:25:42 +0000 (UTC)
X-Virus-Scanned: at lists.debian.org with policy bank en-ht
X-AmavisStatus: No, score=-5.9 tagged_above=-10000 required=5.3
	tests=[BAYES_00=-2, FOURLA=0.1, RCVD_IN_DNSWL_MED=-4] autolearn=no
Received: from liszt.debian.org ([127.0.0.1])
	by localhost (lists.debian.org [127.0.0.1]) (amavisd-new, port 2525)
	with ESMTP id LRoZR7AInPE4 for <lists-debian-user@liszt.debian.org>;
	Mon, 12 Apr 2010 19:25:32 +0000 (UTC)
X-policyd-weight: using cached result; rate: -7
Received: from esrv1.icfo.es (esrv1.icfo.es [84.88.69.10])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(Client CN "smtp.icfo.es", Issuer "TERENA SSL CA" (not verified))
	by liszt.debian.org (Postfix) with ESMTPS id 7336B13A63A5
	for <debian-user@lists.debian.org>; Mon, 12 Apr 2010 19:25:32 +0000 (UTC)
Received: from isar.localhost (ALyon-153-1-83-188.w86-206.abo.wanadoo.fr [86.206.98.188])
	(using TLSv1 with cipher DHE-RSA-AES128-SHA (128/128 bits))
	(No client certificate requested)
	by esrv1.icfo.es (Postfix) with ESMTP id 820E4D18FF3
	for <debian-user@lists.debian.org>; Mon, 12 Apr 2010 21:25:27 +0200 (CEST)
Date: Mon, 12 Apr 2010 21:25:23 +0200
From: Florian Kulzer <florian.kulzer+debian@icfo.es>
To: debian-user@lists.debian.org
Subject: Re: What prevents mounting of USB devices?
Message-ID: <20100412192523.GA8287@isar.localhost>
Mail-Followup-To: debian-user@lists.debian.org
References: <4BC0B36A.6010105@web.de>
 <20100411081621.GA4866@isar.localhost>
 <4BC1C71D.8020406@web.de>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
In-Reply-To: <4BC1C71D.8020406@web.de>
X-Operating-System: Debian GNU/Linux Sid
User-Agent: Mutt/1.5.20 (2009-06-14)
X-Rc-Spam: 2008-11-04_01
X-Rc-Virus: 2007-09-13_01
X-Rc-Spam: 2008-11-04_01
Resent-Message-ID: <HHl-Y-L1sDF.A.5DD.Se3wLB@liszt>
Resent-From: debian-user@lists.debian.org
X-Mailing-List: <debian-user@lists.debian.org> archive/latest/573949
X-Loop: debian-user@lists.debian.org
List-Id: <debian-user.lists.debian.org>
List-Post: <mailto:debian-user@lists.debian.org>
List-Help: <mailto:debian-user-request@lists.debian.org?subject=help>
List-Subscribe: <mailto:debian-user-request@lists.debian.org?subject=subscribe>
List-Unsubscribe: <mailto:debian-user-request@lists.debian.org?subject=unsubscribe>
Precedence: list
Resent-Sender: debian-user-request@lists.debian.org
Resent-Date: Mon, 12 Apr 2010 19:42:10 +0000 (UTC)

On Sun, Apr 11, 2010 at 14:57:01 +0200, Clive McBarton wrote:
> Florian Kulzer wrote:
> > On Sat, Apr 10, 2010 at 19:20:42 +0200, Clive McBarton wrote:
> >> I run KDE and normally mount usb devices with the "Storage Media" applet
> >> in the task bar. Recently I have been getting strange errors and
> >> mounting failed:
> > 
> > Which version of KDE, 3.x or 4.x? (I don't remember a task bar applet
> > for mounting removable media from my KDE 3.x days - I always triggered
> > mounting via the icons that appeared on the desktop for removable media
> > - but I might simply not know about alternatives.)
> 
> 3.x, Lenny default. Probably 3.5.10 if I see correctly. The task bar
> applet is called "Storage Media" or "Media Applet". The right-click
> options in the taskbar are "Move Storage Media", "Remove Storage Media",
> "Configure Storage Media", "About Storage Media". When I bring up its
> preferences it has different ideas about its name and now says "Media
> Applet Preferences - KDE Panel". The "About" says "using KDE 3.5.10".

Did you have any security upgrades lately or did you install packages
from backports or volatile, or any non-Debian stuff? I am surprised that
a stable system should exhibit such a sudden regression.

Another thing to try is to activate the desktop icons for removable
devices and test if users can mount the devices by clicking on the
icons.

> > Mounting worked for you earlier, so I assume that your users are all
> > members of the "plugdev" group already. 
> 
> Yes they are.
> 
> > I would like to see the output of:
> > 
> >   awk '/<policy group="plugdev">/,/<\/policy>/' /etc/dbus-1/system.d/hal.conf
> 
> Here:
> 
>   <policy group="plugdev">
>     <allow send_interface="org.freedesktop.Hal.Device.Volume"
>            send_destination="org.freedesktop.Hal"/>
>     <allow send_interface="org.freedesktop.Hal.Device.Volume.Crypto"
>            send_destination="org.freedesktop.Hal"/>
>   </policy>
> 
> By looking at the modify time, I see that this file has not been
> modified since I installed Debian, so it must still be in the default state.

AFAIK, that is exactly how it should be for Lenny, so all members of the
plugdev group should be able to send dbus messages to hal. Absence of
such permissions is a very common reason for point-click mounting to go
wrong, but that does not seem to be the case for you.

[...]

> >> And the UUID of the usb stick is even listed in /etc/fstab so that it is
> >> supposed to mount automatically when plugged in (though that does not
> >> seem to work). But that may be an unrelated issue.
> > 
> > AFAIK, you should not have any entries in fstab for removable devices
> > that you want to be handled by KDE/Gnome/whatever_other_DE via the
> > dbus/hal mechanism. In any case, I would avoid trying to mix different
> > approaches.
> 
> I would avoid that too, if any single one of them would work, but
> neither did. I did not try pmount so far, that would actually have worked.

I suspect that the fstab entry is not really a problem. Maybe you can
setup pmount for the individual users so that it is more convenient.

Unfortunately I do not understand what else your dbus error message is
trying to tell us. I would run "lshal --monitor", then plug in a USB
stick and try to mount it; maybe that will turn up something useful.

Seeing what hal knows about a USB stick might also help; hal can be
queried like this:

lshal -u $(hal-find-by-property --key block.device --string "/dev/sdX")
lshal -u $(hal-find-by-property --key block.device --string "/dev/sdX1")

(Replace "sdX" as is appropriate)

-- 
Regards,            |
          Florian   |


-- 
To UNSUBSCRIBE, email to debian-user-REQUEST@lists.debian.org 
with a subject of "unsubscribe". Trouble? Contact listmaster@lists.debian.org
Archive: http://lists.debian.org/20100412192523.GA8287@isar.localhost


